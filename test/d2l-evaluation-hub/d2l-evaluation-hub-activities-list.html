<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

		<title>d2l-evaluation-hub test</title>

		<script src="../../../@babel/polyfill/browser.js"></script>
		<script src="../../../@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script>
		<script src="../../../wct-browser-legacy/browser.js"></script>
		<script type="module" src="../../components/d2l-evaluation-hub-activities-list/d2l-evaluation-hub-activities-list.js"></script>
	</head>
	<body>
		<test-fixture id="basic">
			<template strip-whitespace>
				<d2l-evaluation-hub-activities-list href="data/root.json" token="t"></d2l-evaluation-hub-activities-list>
			</template>
		</test-fixture>

		<script>
			suite('d2l-evaluation-hub-activities-list', function() {
				var list;
				setup(function(done) {
					list = fixture('basic');
					function waitForLoad() {
						if (list._loading) {
							setTimeout(waitForLoad, 500);
						} else {
							done();
						}
					}
					waitForLoad();
				});
				test('instantiating the element works', function() {
					assert.equal(list.tagName.toLowerCase(), 'd2l-evaluation-hub-activities-list');
				});
				test('attributes are set correctly', function() {
					assert.equal(list.href, 'data/root.json');
					assert.equal(list.token, 't');
				});
				test('headers display correctly', function() {
					var expected = [
						'Submitter', 'Activity Name', 'Course Name', 'Submission Date'
					];
					var headers = list.shadowRoot.querySelectorAll('d2l-th');
					for (var i = 0; i < expected.length; i++) {
						assert.equal(expected[i], headers[i].innerHTML);
					}
				});
				test('data is imported correctly', function() {
					var expected = [
						{
							displayName: 'User Name',
							courseName: 'Org Name',
							activityName: 'Assignment Name',
							submissionDate: '2018-02-03T17:00:00.000Z',
							activityLink: 'link to activity'
						}
					];
					assert.equal(list._data.length, expected.length);
					assert.deepEqual(list._data, expected);
				});
				test('data displays correctly', function() {
					var expected = [
						'User Name', 'Assignment Name', 'Org Name', '2018-02-03T17:00:00.000Z'
					];
					var data = list.shadowRoot.querySelectorAll('d2l-td');
					for (var i = 0; i < expected.length; i++) {
						assert.equal(expected[i], data[i].innerHTML);
					}
				});
			});
		</script>
	</body>
</html>
